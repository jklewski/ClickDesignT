<!-- shp to geojson https://mapshaper.org/ -->
<!-- dont forget to include original prj file which holds projection-->
<!doctype html>
<html>

<head>
    <!-- load bootstrap-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- load leaflet-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""> </script>
    <!-- import leaflet map-providers (use a free one w/o tokens)-->
    <script src="leaflet-providers.js"></script>
    <!-- Define functions-->
    <script>
        //function for adding information to be added here
        function clickEvent(e) {
            //check if the target has any info
            var cname = e.target.feature.properties.NAME_EN
            var layer = e.target
            for (let i = 0; i < cinfo.length; i++) {
                if (cname.includes(cinfo[i].NAME_EN)) {
                    document.getElementById("info1").innerHTML = String(cinfo[i].reqBio.replace("\\n", '<br>'))
                    document.getElementById("info2").innerHTML = String(cinfo[i].refSL.replace("\\n", '<br>'))
                    document.getElementById("info3").innerHTML = String(cinfo[i].extras.replace("\\n", '<br>'))
                    document.getElementById("extras").innerHTML = String(cinfo[i].extras.replace("\\n", '<br>'))
                    popupText = '"<b>"Requirements:"</b>"' + "<b>" + cinfo[i].reqBio.replace("\\n", '<br>') + "</b>"
                    layer.bindPopup(popupText)
                    //qualityLabel
                    //PCO
                    //law
                } else {
                    //document.getElementById("info1").innerHTML = "NA"
                }
            }

            document.getElementById("instruction").innerHTML = e.target.feature.properties.NAME_EN
        }
        //function for changing the style when mouse over
        function newstyle(e) {
            var targetLayer = e.target;
            targetLayer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 0.7,
                opacity: 0.5,
            });

            if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
                targetLayer.bringToFront();
            }
        }
        //for resetting the style when mouse leaves
        function resetStyle(e) {
            countryLayers.resetStyle(e.target);
        }
        //set two above functions to fire on layer basis
        function onEachFeature(feature, layer) {
            layer.on({
                click: clickEvent,
                mouseover: newstyle,
                mouseout: resetStyle
            });
        }
    </script>

    <script>
        //toggling checkboxes
        function toggleLayer(id) {
            el = document.getElementById(id)
            ind = parseInt(el.id.slice(2))
            clrs = ["#ff0000",
                "#0000ff",
                "#00ff00",
                "#ff00ff",
                "#ffff00",
                "#ffffff",
                "#f0f0f0",
                "#0f0f0f",
                "#0000ff",
                "#00ff00",
                "#ff00ff",
                "#ffff00",
                "#ffffff",
                "#f0f0f0",
                "#0f0f0f"]
            //[ind] refers to location in poly file, which is not necessarily sorted as the pts-data. find corresponding index, ind_pts, in pts-file

            var fts_pol = spec[0].features
  
            if (el.checked) {
                //add polygon layer
                layers[ind] = L.geoJSON(spec[0].features[ind], {
                    style: { color: clrs[ind], weight: 1, opacity: 0.5, fillColor: clrs[ind], fillOpacity: 0.5 }
                }).addTo(map);

                //add multipoint layer (needs to be converted to layer)
                layers_pts[ind_pts] = L.geoJSON(spec_pts[0].features[ind], {
                    pointToLayer: function (feature, latlng) {
                        return L.circleMarker(latlng, {
                            radius: 5,
                            fillColor: clrs[ind],
                            color: clrs[ind],
                            weight: 1,
                            opacity: 0,
                            fillOpacity: 0.5
                        });
                    }
                }).addTo(map);

            } else {
                map.removeLayer(layers[ind])
                map.removeLayer(layers_pts[ind_pts])
            }
        }
    </script>
</head>

<body style="height:100%">
    <div class="container-fluid p-5 bg-dark text-white text-center">
        <h1>Termite mapper</h1>
    </div>
    <p id="instruction">test-text</p>

    <div class="container mt-1">
        <div class="row">
            <div id="buttons1" class="col-sm-4">
                <p>Subterranian termites</p>
            </div>
            <div id="buttons2" class="col-sm-4">
                <p>Drywood termites</p>
            </div>
            <div id="buttons3" class="col-sm-4">
                <p>Wood-boring beetles</p>
            </div>
        </div>
    </div>

    <div id="map"
        style="height:400px; width:50%; margin-left:auto; margin-right:auto; margin-top:20px;border-style: solid;">
    </div>

    <div id="infobox" class="container mt-5">
        <div class="row">
            <div class="col">
                <p><b>Requirements</b></p>
                <p id="info1" style="white-space: pre-line;">Info goes here</p>
            </div>
            <div class="col">
                <p><b>Bio code</b></p>
                <p id="info2" style="white-space: pre-line;">Info goes here</p>
            </div>
            <div class="col">
                <p><b>Extras</b></p>
                <p id="info3" style="white-space: pre-line;">Info goes here</p>
            </div>
            <div class="row">
                <p><b>Extras</b></p>
                <p id="extras"></p>
            </div>
        </div>
    </div>

    <!-- load some data-->
    <script>

        var countryborders = []
        const xhttp = new XMLHttpRequest();
        xhttp.onload = function () {
            countryborders = JSON.parse(this.responseText)
            countryborders = [countryborders]
        }
        xhttp.open("GET", "out_shapefile_country.json", false);
        xhttp.send();

        var spec = []
        const xhttp2 = new XMLHttpRequest();
        xhttp2.onload = function () {
            spec = JSON.parse(this.responseText)
            spec = [spec]
        }
        xhttp2.open("GET", "shp_databaseMK.json", false);
        xhttp2.send();

    </script>

    <script>
        var cinfo = [{ "NAME_EN": "France", "insectRisk": "yes", "regulations": "termite lawn Decree No. 2006-591, referring to Act No. 99-471 of 8 June 1999, designed “to protect buyers and owners of buildings against termites and other xylophagous insects”, specifies the minimum protection requirements which apply during the construction of new buildings or enlargement, improvement and alteration of existing building (all metropolitan and overseas departments)\\nStructural timber has to be protected against wood-boring insects (all country) and termites (regional scale): naturally durable wood, treated or easy to replace/treat in situ.\\nhttps://www.legifrance.gouv.fr/loda/id/JORFTEXT000000577694/ \\nNo legal requirement for non-structural timber (but might be some standard requirement )", "law": "termite law included in the building code", "extras": "http://www.centre-val-de-loire.developpement-durable.gouv.fr/IMG/pdf/Guide_Termites_dans_batiments_neufs_-_septembre_2011_cle7153b7.pdf\\nhttps://www.ecologie.gouv.fr/sites/default/files/dgaln_guide_prevention_termite_janvier_2013.pdf \\nhttps://www.codifab.fr/actions-collectives/comprendre-et-maitriser-la-durabilite-du-bois-2510", "recommendations": "use of termite barriers (mandatory in given areas)", "refMaterials": "EN 350\\n", "duraReq": "structural wood DTU 51.3 \\ndecking (windows and exterior doors) DTU 36.5\\ncladding DT 41.2\\njoineries", "marketFeedback": "UC1 wood used frequently untreated\\nUC 2 structural wood is generally treated or durable wood is used\\nUC 3 wood is generally treated", "refSL": "EN 460\\n", "refPreservative": "FD P 20-651:2012 Durability of wood products and works. Association Francaise de Normalisation (Afnor), Paris.", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "NF B 50-105-3 Durabilité du bois et des matériaux dérivés du bois - Bois et matériaux à base de bois traités avec un produit de préservation préventif - Partie 3 : spécifications de préservation des bois et matériaux à base de bois et attestation de traitement - Adaptation à la France Métropolitaine et aux DOM", "reqBio": "CTB P+\\nCTB P+", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Spain", "insectRisk": "yes", "regulations": "The current regulations on urban planning require a Building Assessment Report (BAR), with energy\\nefficiency being one of the parameters to be measured according to the demands raised by European\\nregulations. The deficiencies of the building conservation incorporates the presence of decay organisms\\nas one of the parameters to be measured. The CTN56 Subcommittee 4 has created a group of experts\\nthat are developing a protocol for the systematization to control termite infestation in urban areas, in\\nthe buildings and in the surrounding area.", "law": "", "extras": "http://www.cscae.com/area_tecnica/aitim/actividades/act_paginas/libro/productos_de_madera_para_la_arquitectura.pdf\\nhttp://www.aemcm.net/archivos/roadmap2010.pdf\\nhttps://www.codigotecnico.org/pdf/Documentos/SE/DBSE-M.pdf", "recommendations": "use of termite barriers", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "In UC1 a preventive treatment against insects is a recommendation in structural timber (or use a\\nnaturally durable wood).\\nIn UC 2, structural timber must be treated with a preventive treatment just a surface one against both insects and fungi (or use a naturally durable wood).", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Portugal", "insectRisk": "yes", "regulations": "Law in Azores for Azores only – Regional Law nº 22/2010/A and documents after (inspired by the French\\nlaw on termites).", "law": "", "extras": "", "recommendations": "use of termite barriers ?", "refMaterials": "EN 350\\n", "duraReq": "The topic of wood durability is only marginally addressed in the national documents.", "marketFeedback": "the few engineers really working on the rehabilitation of timber structures\\nfollow the Italian guidelines or are strongly influenced by them", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Italy", "insectRisk": "yes", "regulations": "In 1952 was promulgated a law (LEGGE 630) for the adoption of measures against the attacks of\\ntermites on Cultural Heritage. This programs run until 1957. Nowadays, nevertheless the termite attacks\\nare present, on cultural heritage and in civil buildings, no legislation or national program are present.", "law": "", "extras": "https://www.federlegnoarredo.it/ContentsFiles/Guida%20Pratica%20alla%20Durabilita%20e%20Trattamenti%20del%20Legno.pdf", "recommendations": "use of termite barriers ?", "refMaterials": "EN 350\\n", "duraReq": "Two national technical norm & document in Italy (NTC 2018 and CNR DT206/2018), quite general\\nThe topic of wood durability is only marginally addressed in the national documents.", "marketFeedback": "EN 460 is the guideline document for the cross-reference of use classes (EN 335) and durability\\nclasses (EN 350)\\nNo more detailed prescriptions for specific uses, nor for specific risks.", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "UNI 9784 Preservazione del legno. Guida alla scelta, all’uso ed ai procedimenti di applicazione dei preservanti del legno.", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Greece", "insectRisk": "no", "regulations": "no", "law": "", "extras": "", "recommendations": "?", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "No specific rules are applied in regard to preventive treatments and/or selection of wood species; sometimes, one can see in the market requirements to apply preventive treatments of some fungicides and insecticides, usually applied by fast dipping, or brushing).", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Croatia", "insectRisk": "missing data", "regulations": "no", "law": "", "extras": "", "recommendations": "?", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Slovenia", "insectRisk": "yes", "regulations": "no", "law": "", "extras": "", "recommendations": "?", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "No specific provisions for classes 1 and 2, basically the notion here is that dried wood is not\\ninteresting to insects.", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Germany", "insectRisk": "yes", "regulations": "no", "law": "\\no The standard allows 5% sapwood and you can still consider this as 100% heartwood.", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "According to the German standard DIN 68 800 indoor components would be assigned to UC 0 if\\nthey are either inaccessible to insects or can be monitored from at least three sides. If so, no\\nchemical wood preservation is needed.\\nThe standard allows 5% sapwood and you can still consider this as 100% heartwood.", "marketFeedback": "", "refSL": "EN 460\\n", "refPreservative": "DIN 68800-1:2019. Holzschutz - Teil 1: Allgemeines. Deutsches Institut für Normung e. V. (DIN), Berlin.", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "RAL", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Austria", "insectRisk": "yes", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "United Kingdom", "insectRisk": "yes", "regulations": "Protection of timber (use class 1 and 2) against house longhorn beetle Hylotrupes bajulus\\naccording to the building regulation, in areas at risk.", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "For UC2 timber BS 8417 (2011) requires treatment for fungi and insects especially where 60 year\\ndesired service life is required for some roof timbers and structural timber frame.", "marketFeedback": "There are hundreds buildings that use untreated non-durable structural timber and most of\\nthem are CLT apartment blocks.", "refSL": "EN 460\\n", "refPreservative": "BS 8417:2011. Preservation of timber. Recommendations. British Standards Institute (BSI), London.", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Belgium", "insectRisk": "yes", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "In UC 2 preventive treatment recommended against both insects and fungi or use of naturally\\ndurable wood", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Netherlands", "insectRisk": "?", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "KOMO", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Denmark", "insectRisk": "Insects are not considered at all or not considered as serious economic threat.", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "Structural timber inside a building is considered UC 1\\nNo requirements regarding wood protection in Use Class 1 and 2.\\nIn use class 2 only potential surface treatments against mould are in some cases recommended but not always needed.\\n", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "NTR", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Sweden", "insectRisk": "Insects are not considered at all or not considered as serious economic threat.", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "Structural timber inside a building is considered UC 1\\nNo requirements regarding wood protection in Use Class 1 and 2.\\nIn use class 2 only potential surface treatments against mould are in some cases recommended but not always needed.\\n", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "NTR", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Norway", "insectRisk": "Insects are not considered at all or not considered as serious economic threat.", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "Structural timber inside a building is considered UC 1\\nNo requirements regarding wood protection in Use Class 1 and 2.\\nIn use class 2 only potential surface treatments against mould are in some cases recommended but not always needed.\\n", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "NTR", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Finland", "insectRisk": "Insects are not considered at all or not considered as serious economic threat.", "regulations": "no", "law": "", "extras": "", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "Structural timber inside a building is considered UC 1\\nNo requirements regarding wood protection in Use Class 1 and 2.\\nIn use class 2 only potential surface treatments against mould are in some cases recommended but not always needed.\\n", "refSL": "EN 460\\n", "refPreservative": "no", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "NTR", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Poland", "insectRisk": "?", "regulations": "no", "law": "", "extras": "http://www.orbikon.pl/wp/wp-content/uploads/2018/01/W12a.pdf", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "", "refSL": "", "refPreservative": "", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }, { "NAME_EN": "Czech Republic", "insectRisk": "?", "regulations": "no", "law": "", "extras": "http://www.orbikon.pl/wp/wp-content/uploads/2018/01/W12a.pdf", "recommendations": "no", "refMaterials": "EN 350\\n", "duraReq": "", "marketFeedback": "", "refSL": "", "refPreservative": "", "refPreservativeNational": "EN 599-1\\nEN 351-1\\n\\n", "qualityLabel": "", "reqBio": "", "PCO": "Biocidal Products Regulation (BPR, Regulation (EU) 528/2012) \\n" }]
    </script>

    <script> //create list of checkboxes, one for each species
        speciesName = [];
        nlayers = spec[0].features.length
        for (let i = 0; i < nlayers; i++) {
            speciesName[i] = spec[0].features[i].properties.Name
        }
        for (var i in speciesName) {
            name = speciesName[i]
            btn = document.createElement("input")
            btn.type = "checkbox"
            btn.id = "id" + i
            btn.value = name;
            btn.onclick = function () { toggleLayer(this.id) }
            p = document.createElement("span");
            p.innerHTML = name;
            br = document.createElement("br");
            if (speciesName[i].includes('Reti')) {
                var group = 1
            } else if (speciesName[i].includes('Kalo')) {
                var group = 2
            } else {
                var group = 3
            }
            document.getElementById("buttons" + group).appendChild(btn)
            document.getElementById("buttons" + group).appendChild(p)
            document.getElementById("buttons" + group).appendChild(br)
        }
    </script>

    <script>



        var map = L.map('map').setView([55, 15], 3);
        L.tileLayer.provider('Stamen.Terrain').addTo(map);
        layers = []
        layers_pts = []
        countryLayers = L.geoJSON(countryborders, {
            style: { "color": "#ff0000", "opacity": 0.0, "fillOpacity": 0.0 },
            onEachFeature: onEachFeature,
            mouseover: newstyle
        }).addTo(map);
    </script>
</body>

</html>